define(["underscore","jquery","String","backbone","../../../services/event.service"],function(e,t,n,i,o){return i.View.extend({el:"#numberVideoList",id:"#numberVideoList",countDownTime:".countDownTime",issue:".issue",textBtn:".textBtn",timeText:".timeText",initialize:function(){var e=this;e.time=1e3,e.timeCountArray=[],e.isRquest=!1,o.on("startCountDown_NumberVideoListComponent",function(){e.countDown()}),o.on("refresh_numberVideoComponent",function(t){e.refresh(t)})},refresh:function(e){var n=this;e?t(n.id).find("li").each(function(i,o){if(e.lotterycode==t(o).attr("data-lotterycode"))return t(o).find(n.issue).html(e.next.period+"期"),t(o).find(n.countDownTime).html(e.awardTimeInterval.SecondsTohhmmss()),t(o).find(n.countDownTime).attr("data-time",e.awardTimeInterval),n.timeCountArray[i]=e.awardTimeInterval,n.isRquest=!1,t(o).find(n.textBtn).show(),t(o).find(n.timeText).hide(),!1}):console.error("refresh：返回来的数据不能为空！")},countDown:function(){var e=this,n=t(e.id).find("li "+e.countDownTime);n.each(function(n,i){e.timeCountArray.push(parseFloat(t(i).attr("data-time")))});window.setInterval(function(){o.emit("observer_numberVideoComponent"),n.each(function(n,i){"00:00:00"==(""+e.timeCountArray[n]).SecondsTohhmmss()&&0==e.isRquest?(e.isRquest=!0,t(i).parent().parent().find(e.textBtn).hide(),t(i).parent().parent().find(e.timeText).show(),t(i).html("00:00:00"),e.timeCountArray[n]=0,window.setTimeout(function(){o.emit("countDownSuccess_numberVideoComponent",t(i).attr("data-lotterycode"))},5e3)):0==e.isRquest&&(t(i).parent().find(e.textBtn).show(),t(i).parent().find(e.timeText).hide(),e.timeCountArray[n]--,t(i).html((""+e.timeCountArray[n]).SecondsTohhmmss()))})},e.time)}})});