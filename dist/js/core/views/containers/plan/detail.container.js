define("core/services/testing.service",["jquery"],function(e){return{isDev:"false"!==e("body").attr("isopeneventnamecheck"),_testingEventName:function(e){return this.isDev?!!/_[\w]*/.test(e):(console.error("body标签上没有设置isOpenEventNameCheck属性！用于开启是否事件名规范校验！"),!1)}}}),define("core/services/event.service",["underscore","jquery","backbone","./testing.service"],function(e,t,n,i){return{_on:function(e,t){"string"==typeof e&&"function"==typeof t?i._testingEventName(e)?(this[e]=this[e]||new Array,this[e].push(t)):console.error("您得事件未指定是从那个组件接收得，请按照事件命名规范编写事件名字！例子：事件名_接收组件(需要加上Component)"):console.error("事件参数不正确！")},_emit:function(e){if("string"==typeof e)if(i._testingEventName(e)){var t=arguments.length>1?Array.prototype.slice.call(arguments,1):[];this[e]&&Array.prototype.forEach.call(this[e],function(e){e.apply(this,t)})}else console.error("您得事件未指定是从那个组件接收得，请按照事件命名规范编写事件名字！例子：事件名_接收组件(需要加上Component)")},on:function(e,t){"string"==typeof e&&"function"==typeof t?i._testingEventName(e)?n.on(e,t):console.error("您得事件未指定是从那个组件接收得，请按照事件命名规范编写事件名字！例子：事件名_接收组件(需要加上Component)"):console.error("事件参数不正确！")},emit:function(e,t){"string"==typeof e&&(i._testingEventName(e)?n.trigger(e,t):console.error("您得事件未指定是从那个组件接收得，请按照事件命名规范编写事件名字！例子：事件名_接收组件(需要加上Component)"))}}}),define("core/model/alertPlugin.model",["underscore","jquery","backbone","../services/event.service"],function(e,t,n,i){return n.Model.extend({defaults:{content:"",title:"提示",btnText:"确定",okCallback:""}})}),define("core/views/publicComponent/public/alertPlugin.component",["underscore","jquery","backbone","../../../services/event.service","../../../model/alertPlugin.model"],function(e,t,n,i){return n.View.extend({tagName:"div",className:"public-popUpWindows",id:"eyuAlert",attributes:{style:"display: block;"},events:{"click .close":"closeAlert","click .btn":"okAlert"},initialize:function(){this.render()},render:function(){return this.$el.html('<div class="puw-contentB"><div class="titleB"><span class="title">'+this.model.get("title")+'</span><i class="close"></i></div><div class="content">'+this.model.get("content")+'</div><span class="btn">'+this.model.get("btnText")+"</span></div>"),this},closeAlert:function(){t("#eyuAlert").remove();var e=this.model.get("closeCallback");"function"==typeof e&&e.call(this),i.emit("closeAlert_component")},okAlert:function(){t("#eyuAlert").remove();var e=this.model.get("okCallback");"function"==typeof e&&e.call(this),i.emit("okAlert_component")},show:function(){this.$el.appendTo(t("body"))}})}),define("core/views/containers/plan/detail.container",["underscore","jquery","backbone","Date","String","template","../../publicComponent/public/alertPlugin.component","../../../model/alertPlugin.model"],function(e,t,n,i,o,l,r,a){var c={initialize:function(){this.initEvent()},initEvent:function(){t(document).on("input keyup",".chn_lotListBlock input",this.inputValue),t(document).on("click","#btnPlan",this.generatePlan.bind(this,!1)),t(document).on("input keyup",".form_btnBlock input",this.inputMulite),t(document).on("click","[data-arrow]",this.arrowMulite),t(document).on("click","#planRender a",this.showPlanRender)},generatePlan:function(e){if(c.validateValue()){for(var t=c.betValue(),n=0,i=[],o=!0,l=0;l<t.betPeriod;l++){var s=2*t.bet*t.multiple+n,u=(t.money*t.multiple-s)/s*100;if(u<0&&0===l){var p=new a({content:"组合不合理，请重新输入参数",btnText:"确定"});new r({model:p}).show(),o=!1;break}if(u>=t.profit)i.push({num:l+1,bet:t.bet,multiple:t.multiple,totalMoney:s,lastTotalMoney:n,money:t.money*t.multiple-s,profit:u.toFixed(2)}),n=s;else{if(0==l){var p=new a({content:"该方案初始最大盈利为"+u+"%",btnText:"确定"});new r({model:p}).show(),o=!1;break}if(!(t.multiple<3e3))break;for(;u<t.profit&&t.multiple<3e3;)t.multiple++,s=2*t.bet*t.multiple+n,u=(t.money*t.multiple-s)/s*100;t.multiple<3e3&&(i.push({num:l+1,bet:t.bet,multiple:t.multiple,totalMoney:s,lastTotalMoney:n,money:t.money*t.multiple-s,profit:u.toFixed(2)}),n=s)}}if(!o)return;if(i.length<t.betPeriod&&!e){var p=new a({content:"该方案最多生成"+i.length+"期",btnText:"确定",okCallback:c.renderPlan.bind(this,i)});new r({model:p}).show()}else c.renderPlan(i)}},renderPlan:function(e){var n={};n.list=e;var i=l("planBlockList",n);t("#planDetailTable").html(i)},getValue:function(){var e={};return e.bet=t("#bet").val(),e.betPeriod=t("#betPeriod").val(),e.profit=t("#profit").val(),e.multiple=t("#multiple").val(),e.money=t("#money").val(),e.bet=e.bet.replace(/[^0-9]/g,""),e.betPeriod=e.betPeriod.replace(/[^0-9]/g,""),e.profit=e.profit.replace(/[^0-9]/g,""),e.multiple=e.multiple.replace(/[^0-9]/g,""),e.money=e.money.replace(/[^0-9]/g,""),e.bet=e.bet<=0?1:e.bet,e.betPeriod=e.betPeriod<=0?1:e.betPeriod,e.profit=e.profit<=0?1:e.profit,e.multiple=e.multiple<=0?1:e.multiple,e.money=e.money<=0?1:e.money,t("#bet").val(e.bet),t("#betPeriod").val(e.betPeriod),t("#profit").val(e.profit),t("#multiple").val(e.multiple),t("#money").val(e.money),e},validateValue:function(){for(var e=this.getValue(),t=Object.keys(e),n=t.length,i=!0,o=0;o<n;o++){var l=e[t[o]];if(l&&!/^[0-9]*$/.test(l)){var c=new a({content:"填写参数有误，只允许填写数字",btnText:"确定"});new r({model:c}).show(),i=!1;break}if(!l){i=!1;break}}return i},inputValue:function(){for(var e=c.getValue(),n=Object.keys(e),i=n.length,o=!0,l=0;l<i;l++){if(!e[n[l]]){o=!1,t("#btnPlan").css({background:"#ccc"});break}}o&&t("#btnPlan").css({background:"#e33d3d"})},betValue:function(){for(var e=this.getValue(),t=Object.keys(e),n=t.length,i={},o=0;o<n;o++)i[t[o]]=parseInt(e[t[o]]);return i},reGenerateLine:function(e){var t={};return t.list=[e],l("planBlockList",t).replace("<tr>","").replace("</tr>","")},changeMulite:function(e,n){var i="",o=parseInt(t("#money").val());return n&&/^[0-9]*$/.test(n)&&(e.multiple=parseInt(n),e.totalMoney=2*e.bet*e.multiple+e.lastTotalMoney,e.profit=((o*e.multiple-e.totalMoney)/e.totalMoney*100).toFixed(2),e.money=o*e.multiple-e.totalMoney,i=this.reGenerateLine(e)),i},inputMulite:function(){var e=t(this).data("item"),n=t(this).val();n&&(n=n.replace(/[^0-9]/g,""),n=n<=0?1:n,n>3e3&&(n=3e3),t(this).val(n));var i=c.changeMulite(e,n);i&&t(this).parent().parent().parent().parent().html(i).find("input").val("").focus().val(n)},arrowMulite:function(){var e=t(t(this).parent().find("input")[0]),n=e.data("item"),i=e.val(),o=t(this).data("arrow");if(i&&/^[0-9]*$/.test(i)){"left"==o?i>1&&i--:i<3e3&&i++;var l=c.changeMulite(n,i);l&&(t(this).parent().parent().parent().html(l),e.val(i))}},showPlanRender:function(){"none"==t(".chn_lotListBlock").css("display")?(t(".chn_lotListBlock").show(),t(this).text("隐藏追号计划"),c.generatePlan(!0)):(t(".chn_lotListBlock").hide(),t(this).text("生成追号计划"))}};return c});